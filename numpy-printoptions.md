---
title: Numpy set_printoptionså‡½æ•°ç”¨æ³•
date: 2023-09-30 12:57:30
tags:
 - Python
 - Numpy
---

Numpyæ˜¯Pythonä¸­å¸¸ç”¨çš„æ•°å€¼è®¡ç®—åº“ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç”¨åˆ°Numpyæ¥æ‰“å°æ•°å€¼ï¼ŒæŸ¥çœ‹ç»“æœã€‚ä¸ºäº†èƒ½ç²¾ç¡®åœ°æ§åˆ¶Numpyæ‰“å°çš„ä¿¡æ¯ï¼ŒNumpyæä¾›äº†`set_printoptions` [å‡½æ•°](https://numpy.org/doc/stable/reference/generated/numpy.set_printoptions.html)ï¼ŒåŒ…å«æ•°ä¸ªå‚æ•°ï¼Œèƒ½æ»¡è¶³æ•°å€¼æ‰“å°çš„éœ€è¦ã€‚

è¿™é‡Œä»¥iPythonä¸­æ“ä½œä½œä¸ºç¤ºä¾‹ï¼Œä»æµ…å…¥æ·±ï¼Œä¸€æ­¥æ­¥åœ°æ¢ç´¢set_printoptionsæä¾›çš„åŠŸèƒ½ï¼Œå¦‚ä½•æ¥æ»¡è¶³æˆ‘ä»¬çš„æ‰“å°éœ€æ±‚ã€‚
<!--more-->

### precision
é¦–å…ˆç”¨Numpyåˆ›å»ºä¸€ä¸ªfloat64 ç±»å‹çš„np.ndarrayï¼Œå¹¶æ‰“å°æ•°å€¼ï¼š
```python
In [1]: import numpy as np

In [2]: a = np.random.rand(3)

In [3]: print(a)
[0.63039295 0.09185505 0.02203224]
```
å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„floatæ•°ç»„ä¿ç•™äº†8ä½å°æ•°ä½ï¼Œè¿™æ˜¯å› ä¸ºNumpyé»˜è®¤çš„è®¾ç½®æ˜¯æ˜¾ç¤º8ä½å°æ•°ä½ã€‚
å¦‚æœåªæƒ³æ˜¾ç¤º2ä½å°æ•°ä½ï¼Œè¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ
è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°`set_printoptions`çš„`precsion`çš„é€‰é¡¹äº†ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æ§åˆ¶æ˜¾ç¤ºçš„å°æ•°ä½ï¼š
```python
In [4]: np.set_printoptions(precision=4)

In [5]: print(a)
[0.6304 0.0919 0.022 ]
```

å¯ä»¥çœ‹åˆ°é€šè¿‡è®¾ç½®precsion=4ï¼Œæ˜¾ç¤ºçš„æ•°ç»„è¾“å‡ºä¿ç•™4ä½å°æ•°ã€‚

âš ï¸éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªè®¾ç½®å¯¹floatç±»å‹çš„æ•°å€¼æ— æ•ˆï¼š
```python
In [14]: a = np.random.rand()

In [15]: type(a)
Out[15]: float

In [16]: print(a)
0.40944018143470295

In [17]: np.set_printoptions(precision=4)

In [18]: print(a)
0.40944018143470295
```

æ‰€ä»¥ä½¿ç”¨æ—¶æ³¨æ„ç±»å‹æ˜¯`np.ndarray`è¿˜æ˜¯`float`ã€‚

### suppress
å‡è®¾æˆ‘ä»¬éœ€è¦è·å–ä¸€ç»„å¾ˆå°çš„æ•°å€¼ï¼Œå¹¶ä¸”éœ€è¦æ˜¾ç¤ºç»“æœï¼š
```python
In [2]: a = np.random.rand(3) * 1e-5

In [3]: print(a)
[9.49522547e-06 4.55101001e-06 4.01284118e-06]

```
å¯ä»¥çœ‹åˆ°æ‰“å°æ—¶ç”¨äº†ç§‘å­¦è®¡æ•°æ³•ã€‚
æœ‰æ²¡æœ‰åŠæ³•ä¸ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•å‘¢ï¼Œ`set_printoptions`æä¾›äº†`suppress`å‚æ•°ï¼Œå°†å…¶è®¾ç½®ä¸º`True`ï¼Œå°±ä¼šç¦ç”¨ç§‘å­¦è®¡æ•°æ³•ï¼š

```python
In [4]: np.set_printoptions(suppress=True)

In [5]: print(a)
[0.0000095  0.00000455 0.00000401]
```


`suppress` å‚æ•°æœ‰ä¸€ä¸ªä¾‹å¤–æƒ…å†µï¼Œå°±æ˜¯å¯¹äºæ•´æ•°éƒ¨åˆ†å¤§äº8ä½çš„ï¼Œå³ä½¿è®¾ç½®`suppress=True` ï¼Œä»ç„¶ä¼šæ˜¾ç¤ºç§‘å­¦è®¡æ•°æ³•ï¼š
```python
In [8]: a = np.random.rand(3) * 1e10

In [9]: print(a)
[9.35772525e+09 4.14513333e+09 4.59176775e+09]

In [10]: a = np.random.rand(3) * 1e8

In [11]: print(a)
[37984517.91633694 87748330.34519586 21101693.42416701]

In [12]: a = np.random.rand(3) * 1e9

In [13]: print(a)
[4.46826342e+08 5.17327105e+08 9.07218130e+08]
```

é‚£æœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿè¿™é‡Œå°±éœ€è¦ç”¨åˆ°`set_printoptions` æä¾›çš„å¦ä¸€ä¸ªå‚æ•°`formatter`ã€‚

### formatter
`formatter`æ¥å—ä¸€ä¸ªdictç±»å‹çš„å‚æ•°ï¼Œå…¶ä¸­dictçš„keyè¡¨ç¤ºå‚æ•°çš„ç±»å‹ï¼Œè€Œdictçš„valueåˆ™æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–è€…formatå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå¦‚ä½•å¯¹å¯¹åº”çš„ç±»å‹è¿›è¡Œæ‰“å°ã€‚

ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘æƒ³åœ¨æ‰€æœ‰floatç±»å‹çš„æ•°ç»„çš„æ¯ä¸ªå…ƒç´ åé¢åŠ ä¸€ä¸ªå­—æ¯`f`:
```python
In [21]: a = np.random.rand(3)

In [22]: np.set_printoptions(precision=4, formatter={'float': lambda x: str(x) + 'f'})

In [23]: print(a)
[0.6925034861246904f 0.0613911477046164f 0.3348313234151774f]
```
`formatter`å‚æ•°æ˜¯ä¸ªdictï¼Œkeyæ˜¯â€œfloat"ï¼Œè¡¨ç¤ºå¯¹floatç±»å‹çš„æ•°ç»„è¿›è¡Œæ“ä½œï¼Œvalueæ˜¯ä¸€ä¸ªlambdaå‡½æ•°ï¼Œå°†è¾“å…¥è½¬æ¢ä¸ºstrå­—ç¬¦ä¸²å†åŠ ä¸€ä¸ªfã€‚

åœ¨è¿™é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œnp.float64æ•°ç»„ä¸­å…ƒç´ çš„å®é™…é•¿åº¦æ˜¯16ä½å°æ•°ã€‚é»˜è®¤æ˜¾ç¤ºçš„8ä½æ•°å€¼åªæ˜¯å®ƒçš„ä¸€ä¸ªè¿‘ä¼¼ã€‚

é™¤äº†lamdaå‡½æ•°å¤–ï¼Œä¹Ÿå¯ä»¥ç”¨Pythonçš„formatæ ¼å¼å‡½æ•°æ¥ä½œä¸º`formatter`å‚æ•°dictçš„valueï¼š
```python
In [33]: a = np.random.rand(3)

In [34]: np.set_printoptions(formatter={'float': '{:.2f}'.format})

In [35]: print(a)
[0.70 0.91 0.82]
```
å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå¯ä»¥ç”¨f-stringå’Œformatå‡½æ•°ä¸­ä½¿ç”¨çš„è¯­æ³•æ ¼å¼ï¼Œå¯¹äºç”¨æƒ¯f-stringçš„å°ä¼™ä¼´æ¥è¯´ï¼Œä»¥è¿™ç§æ–¹å¼æ¥æ§åˆ¶æ˜¾ç¤ºæ ¼å¼ç®€ç›´å¤ªèˆ’æœäº†ã€‚

å…³äºpython formatçš„è¯­æ³•ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„[æ•™ç¨‹](https://zhuanlan.zhihu.com/p/632687543)ã€‚

å¦å¤–éœ€è¦æ³¨æ„ï¼Œè®¾ç½®`formatter`åï¼Œä¼šè¦†ç›–`precision`å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ˜¾ç¤ºå¤šå°‘ä½æ•°ä»¥`formatter`ä¸­è®¾ç½®ä¸ºå‡†:
```python
In [25]: a = np.random.rand(3)

In [26]: np.set_printoptions(precision=4, formatter={'float': lambda x: str(x) + 'f'})

In [27]: print(a)
[0.1604388367489663f 0.6047908263355061f 0.1645621828526913f]
```

æ ¹æ®Numpy æ–‡æ¡£ï¼Œ`formatter`æ”¯æŒçš„ç±»å‹åŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼š
- â€˜boolâ€™
- â€˜intâ€™
- â€˜timedeltaâ€™ : aÂ [`numpy.timedelta64`](https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.timedelta64 "numpy.timedelta64")
- â€˜datetimeâ€™ : aÂ [`numpy.datetime64`](https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.datetime64 "numpy.datetime64")
- â€˜floatâ€™
- â€˜longfloatâ€™ : 128-bit floats
- â€˜complexfloatâ€™
- â€˜longcomplexfloatâ€™ : composed of two 128-bit floats
- â€˜numpystrâ€™ : typesÂ [`numpy.bytes_`](https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.bytes_ "numpy.bytes_")Â andÂ [`numpy.str_`](https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.str_ "numpy.str_")
- â€˜objectâ€™ :Â _np.object__Â arrays
- â€˜allâ€™ : sets all types
- â€˜int_kindâ€™ : sets â€˜intâ€™
- â€˜float_kindâ€™ : sets â€˜floatâ€™ and â€˜longfloatâ€™
- â€˜complex_kindâ€™ : sets â€˜complexfloatâ€™ and â€˜longcomplexfloatâ€™
- â€˜str_kindâ€™ : sets â€˜numpystr

å¥½äº†ï¼Œè¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£å›åˆ°ä¸Šé¢çš„é—®é¢˜ï¼Œåˆ°åº•è¯¥æ€ä¹ˆæ§åˆ¶æ•´æ•°ä½å¤§äº8çš„floatæ•°ç»„ä¸ç”¨ç§‘å­¦è®¡æ•°æ³•å‘¢ï¼Ÿæœ‰äº†formatterå‚æ•°ï¼Œå°±å¾ˆç®€å•äº†ï¼š
```python
In [36]: a = np.random.rand(3) * 1e10

In [37]: np.set_printoptions(formatter={'float': '{:.8f}'.format})

In [38]: print(a)
[7694883457.28612423 864845466.08411431 6505022487.23314571]
```
ä½¿ç”¨formatæ ¼å¼è¯­è¨€è½»æ¾å®Œæˆã€‚

æœ‰äº›æ—¶å€™ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ é•¿åº¦å„ä¸ç›¸åŒï¼Œæ‰“å°æ—¶è¦ä¹ˆå¯¹ä¸é½ä¸å¥½æŸ¥çœ‹ï¼Œè¦ä¹ˆè‡ªåŠ¨è½¬æ¢ä¸ºç§‘å­¦è®¡æ•°æ³•ä¹Ÿä¸å¥½åˆ†æï¼Œåˆ©ç”¨`formatter`èƒ½å¤Ÿæ˜¾ç¤ºå¯¹é½çš„æ•°å€¼ï¼Œå¤§å¤§æ–¹ä¾¿äº†æ•°æ®æŸ¥çœ‹ï¼š
```python
In [1]: import numpy as np

In [2]: a = np.array(
   ...: [[1,  -1000, 2222222222.33333333],
   ...: [233, 240.03333333333333333333333333, 8.0],
   ...: [1.0, 2.0, 3.0]]
   ...: )

In [3]: print(a)
[[ 1.00000000e+00 -1.00000000e+03  2.22222222e+09]
 [ 2.33000000e+02  2.40033333e+02  8.00000000e+00]
 [ 1.00000000e+00  2.00000000e+00  3.00000000e+00]]

In [4]: np.set_printoptions(formatter={'float': '{:>20.8f}'.format})

In [5]: print(a)
[[          1.00000000       -1000.00000000  2222222222.33333349]
 [        233.00000000         240.03333333           8.00000000]
 [          1.00000000           2.00000000           3.00000000]]
```
è¿™é‡Œåˆ©ç”¨äº†`>N`çš„formatè¯­æ³•ï¼Œå‘å³å¯¹é½ã€‚

### thresholdå’Œedgeitems
å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æ•°ç»„(1024x4)ï¼Œæ‰“å°æ—¶é»˜è®¤åªæ˜¾ç¤ºå¼€å§‹ä¸‰è¡Œå’Œæœ€åä¸‰è¡Œï¼š

```python
In [1]: import numpy as np

In [2]: a = np.random.rand(1024, 4)

In [3]: print(a)
[[0.5159347  0.06396333 0.18446106 0.06163127]
 [0.96894042 0.278889   0.25117021 0.9757328 ]
 [0.42980522 0.44724705 0.89322128 0.19697129]
 ...
 [0.31956847 0.4790065  0.45595315 0.98816687]
 [0.35240443 0.44400784 0.76815952 0.18499155]
 [0.33888548 0.50811964 0.32341108 0.98617324]]
```
è¿™æ˜¯å› ä¸ºNumpyé»˜è®¤è®¾ç½®ï¼Œå½“æ•°ç»„çš„å…ƒç´ ä¸ªæ•°å¤§äº1000æ—¶ï¼Œå°±ä¼šåªæ˜¾ç¤ºå¼€å¤´å’Œç»“å°¾éƒ¨åˆ†ã€‚


å¦‚æœæƒ³å¤šæ˜¾ç¤ºä¸€äº›æ•°æ®ï¼Œçœ‹æ›´å¤šå†…å®¹ï¼Œè¯¥æ€ä¹ˆæ“ä½œå‘¢ï¼Ÿ
`set_printoptions`æä¾›äº†`threshold`å‚æ•°ï¼Œç”¨äºæ§åˆ¶å¤šå°‘ä¸ªå…ƒç´ åæ˜¾ç¤ºéƒ¨åˆ†ï¼Œå¦ä¸€ä¸ªå‚æ•°`edgeitems`,æ§åˆ¶æ˜¾ç¤ºç¼©ç•¥éƒ¨åˆ†çš„è¡Œæ•°ã€‚

å› æ­¤å¯ä»¥ä¿®æ”¹è¿™ä¸¤ä¸ªå‚æ•°ï¼Œä¿®æ”¹æ˜¾ç¤ºæ•ˆæœï¼š
```python
In [4]: np.set_printoptions(edgeitems=5)

In [5]: print(a)
[[0.5159347  0.06396333 0.18446106 0.06163127]
 [0.96894042 0.278889   0.25117021 0.9757328 ]
 [0.42980522 0.44724705 0.89322128 0.19697129]
 [0.41831831 0.32864348 0.9599147  0.04244498]
 [0.17307071 0.70541496 0.12485861 0.68987846]
 ...
 [0.36880553 0.66404444 0.12623872 0.32754608]
 [0.53076768 0.76770867 0.36680954 0.58596153]
 [0.31956847 0.4790065  0.45595315 0.98816687]
 [0.35240443 0.44400784 0.76815952 0.18499155]
 [0.33888548 0.50811964 0.32341108 0.98617324]]
```
### linewidth
linewidthå‚æ•°ç”¨æ¥æ§åˆ¶ä¸€è¡Œæ˜¾ç¤ºå¤šå°‘ä¸ªå­—ç¬¦ï¼Œé»˜è®¤æ˜¯75ï¼Œé€šè¿‡ä¿®æ”¹è¿™ä¸ªå‚æ•°ï¼Œèƒ½åœ¨ä¸€è¡Œæ˜¾ç¤ºæ›´å¤šæ•°æ®ï¼š
```python
n [3]: import numpy as np

In [4]: a = np.random.rand(1024,6)

In [5]: np.set_printoptions(precision=16)

In [6]: print(a)
[[0.6151590922948798 0.8394381715187383 0.1287492144726177
  0.432486748198503  0.008210600687992  0.5251777687645207]
 [0.8986836534319551 0.5275521098334796 0.1275787604074625
  0.2088067024068581 0.9728215202746345 0.0222310180458779]
 [0.1919751621010076 0.7593251629630882 0.2216025287318845
  0.1693395870716256 0.0447174013709218 0.2669167788671162]
 ...
 [0.2056367250351134 0.1961953658298233 0.6844119224272207
  0.396808314963211  0.2270659358855954 0.1694468143457141]
 [0.0404784779577213 0.977932794679906  0.319154876583544
  0.6301954893143036 0.4533581710958777 0.4980767389069806]
 [0.5722796781670568 0.8683487818109435 0.819417328117305
  0.5286251921005498 0.2252964609019765 0.7439441509500194]]

In [7]: np.set_printoptions(linewidth=150)

In [8]: print(a)
[[0.6151590922948798 0.8394381715187383 0.1287492144726177 0.432486748198503  0.008210600687992  0.5251777687645207]
 [0.8986836534319551 0.5275521098334796 0.1275787604074625 0.2088067024068581 0.9728215202746345 0.0222310180458779]
 [0.1919751621010076 0.7593251629630882 0.2216025287318845 0.1693395870716256 0.0447174013709218 0.2669167788671162]
 ...
 [0.2056367250351134 0.1961953658298233 0.6844119224272207 0.396808314963211  0.2270659358855954 0.1694468143457141]
 [0.0404784779577213 0.977932794679906  0.319154876583544  0.6301954893143036 0.4533581710958777 0.4980767389069806]
 [0.5722796781670568 0.8683487818109435 0.819417328117305  0.5286251921005498 0.2252964609019765 0.7439441509500194]]
```
å¯ä»¥çœ‹åˆ°ï¼Œå¢åŠ linewidthåˆ°150åï¼Œä»¥å‰ä¸€è¡Œæ˜¾ç¤ºä¸äº†çš„æ•°æ®ç°åœ¨å¯ä»¥åœ¨ä¸€è¡Œä¸Šæ˜¾ç¤ºäº†ã€‚

### nanstrå’Œinfstr
nanstrå’Œinfstrå‚æ•°ç”¨æ¥æ§åˆ¶nanå’Œinfæ•°å€¼çš„æ˜¾ç¤ºå­—ç¬¦ï¼Œé»˜è®¤æ˜¯`nan`å’Œ`inf`ï¼Œå¦‚æœå¥½å¥‡æƒ³ä¿®æ”¹çš„è¯ï¼Œå¯ä»¥è®¾ç½®å¯¹åº”çš„å‚æ•°ï¼š
```python
In [12]: a = np.array([np.nan, np.inf])

In [13]: print(a)
[nan inf]

In [14]: np.set_printoptions(nanstr='éæ•°', infstr='âˆ')

In [15]: print(a)
[éæ•°  âˆ]
```
æœ‰ç‚¹å¥½ç©ï¼Œä½†å»ºè®®åˆ«ä¿®æ”¹ï¼Œä¸ç„¶åˆ«äººä¸çŸ¥é“ä½ åœ¨do what ğŸ¤·

### sign
signå‚æ•°ç”¨æ¥æ§åˆ¶æ¯ä¸ªæ•°å­—å‰æ˜¾ç¤ºçš„ç¬¦å·ï¼Œé»˜è®¤æ˜¯`-`,ä¹Ÿå°±æ˜¯åªæœ‰è´Ÿæ•°å‰é¢æ˜¾ç¤ºå‡å·ã€‚å¦‚æœæ˜¯`+`ï¼Œåˆ™åœ¨æ­£æ•°å‰é¢æ·»åŠ åŠ å·ã€‚å¦‚æœæ˜¯` `,åˆ™åœ¨æ­£æ•°å‰é¢æ·»åŠ ç©ºæ ¼ï¼š
```python
In [1]: import numpy as np

In [2]: a = np.random.rand(3) - 0.5

In [3]: print(a)
[ 0.44889495 -0.25608263 -0.23228835]

In [4]: np.set_printoptions(sign='+')

In [5]: print(a)
[+0.44889495 -0.25608263 -0.23228835]

In [7]: np.set_printoptions(sign=' ')

In [8]: print(a)
[ 0.44889495 -0.25608263 -0.23228835]
```

### æ¢å¤é»˜è®¤é…ç½®
å¦‚ä½•æ¢å¤é»˜è®¤é…ç½®å‘¢ï¼Ÿå¯ä»¥è¿™ä¹ˆè®¾ç½®ï¼š
```python
np.set_printoptions(edgeitems=3, infstr='inf',linewidth=75, nanstr='nan', precision=8,suppress=False, threshold=1000, formatter=None)
```

### ä½¿ç”¨withè¯­å¥
é€šè¿‡ä½¿ç”¨withè¯­å¥ï¼Œå¯ä»¥ä¸´æ—¶ä¿®æ”¹æ‰“å°é…ç½®é¡¹ï¼Œåœ¨é€€å‡ºwithè¯­å¥çš„æ—¶å€™æ¢å¤é»˜è®¤é…ç½®ï¼Œè¿™æ ·ä¹Ÿå‡å°‘ä¾µå…¥å¼åœ°ä¿®æ”¹ï¼Œé¿å…é€ æˆä¸å¿…è¦çš„åæœã€‚
åœ¨ä½¿ç”¨withè¯­å¥æ—¶ï¼Œéœ€è¦å°†`np.set_printoptions` æ›¿æ¢ä¸º`np.printoptions`ï¼Œä¹Ÿå°±æ˜¯å»æ‰å‡½æ•°ä¸­çš„`set_`å‰ç¼€ï¼Œå‡½æ•°çš„æ‰€æœ‰å‚æ•°éƒ½ä¸€æ ·ã€‚ä½¿ç”¨ä¾‹å­ï¼š
```python
In [6]: a = np.random.rand(3)

In [7]: with np.printoptions(formatter={'float': lambda x: str(x)+'f'}):
   ...:     print(a)
   ...:
[0.24752544521208586f 0.01852100917834376f 0.9358432384604951f]

In [8]: print(a)
[0.24752544521208586f 0.01852100917834376f 0.9358432384604951f]
```

è¿™å°±æ˜¯`set_printoptions`å‡ ä¹å…¨éƒ¨çš„å‚æ•°äº†ï¼Œæ›´å¤šç”¨æ³•ï¼Œå‚è€ƒå®˜æ–¹[æ–‡æ¡£](https://numpy.org/doc/stable/reference/generated/numpy.set_printoptions.html)ã€‚
