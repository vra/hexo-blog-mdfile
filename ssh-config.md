title: SSH config使用教程和总结
date: 2017-07-09 17:29:11
tags:
 - Linux
 - SSH
 - 总结

---
SSH config是Linux系统下针对SSH客户端的一个参数配置方案，可以将一些关于SSH命令的参数放到配置文件中去，执行ssh命令的时候从文件中读取，简化命令行的操作。这篇短博客记录ssh config相关的配置问题和使用方法。
<!--more-->
## 概述
SSH 参数配置有3个层次：
 1. 命令行参数，如`-p 10086`, `-i /path/to/identity_file` 等选项来设置SSH的端口号或认证证书位置
 2. 针对某个用户的配置文件，所在路径为`~/.ssh/config`，默认是不存在的，需要手动创建
 3. 针对系统所有用户的配置文件，，所在路径为`/etc/ssh/ssh_config`
参数重要性的顺序也是1>2>3，即越近的配置重要性越高。这里主要讲述第2种情况下的配置方式，即针对`~/.ssh/config`文件的写法进行说明。  

一个示例的文件如下：
```bash
# configuration 1
Host cluster
	HostName 192.168.11.11
	User tom


# configuration 2
Host=aliyun
	Hostname=202.44.2.2
	User tom
```
主要的规则如下：
 1. 每项配置都是`参数名 参数值`或`参数值=参数名`的形式，其中参数名不区分大小写，而参数值区分大小写，如上面的参数名`HostName`和`Hostname`是同一个参数
 2. 不同主机的配置通过`Host`参数来区分，一个配置文件里面可以有针对多个Host的配置
 3. 以`#`开头的是注释，会被忽略
 4. 同一个Host的配置内部，`参数名 参数值`和`参数值=参数名`的形式可以混用，如上例#2配置所示
下面详细展开常见的参数类型。

## 常见参数类型
###Host
类似昵称，用于标识某个特定的配置，在ssh命令中使用，例如我们想要ssh连接到上例中的#1配置的主机，则在命令行执行如下命令即可：
```bash
ssh cluster
```
一个最有用的场景是使用scp在不同主机间传数据。没有配置之间，你得写很长的参数，如
```bash
scp a.txt tom@192.168.11.11:~/
```
尤其是IP地址记忆起来好麻烦啊。配置过上例中的文件后，这个任务可以简化成这样：
```bash
scp a.txt cluster:~/
```
省略了用户名和IP地址，方便多了。  

### HostName
需要ssh连接过去的主机名，一般是IP地址，也可以用`%h`来替代命令行参数，这种情况由于我用的不多，所以没有深入了解，具体情况可以参考参考链接。  

### User
登录主机的用户名

### IdentityFile
认证证书文件，默认位置是`~/.ssh/id_rsa`, `~/ssh/id_dsa`等，如果采用默认的证书，可以不用设置此参数，除非你的证书放在某个自定义的目录，那么你就需要设置该参数来指向你的证书

### Port 
SSH访问主机的端口号，默认是22端口，同上，只有在非默认情况下才需要设置该值

### 其他
貌似常用的参数就这些，别的参数可以在命令行通过`man ssh_config`来查看，其实涉及的参数还是非常多的。 


## 参考链接
1. <http://zlong.org/2015/06/08/ssh-config/>
2. <https://www.hi-linux.com/posts/14346.html>
3. <http://daemon369.github.io/ssh/2015/03/21/using-ssh-config-file>
